package projet_prod_cons;

import jus.poc.prodcons.*;

public class TestProdCons  extends Simulateur {
	private Observateur Obs;
	
	public TestProdCons(Observateur observateur) {
		super(observateur);
		this.Obs=observateur;
	}

	

	@Override
	protected void run() throws Exception {
		// TODO Auto-generated method stub
		//corps du programme principal
		//TODO recuperer l nombre de producteur 
		int nb_prod=10;
		//TODO recuperer nombre conso
		int nb_conso=5;
		
	//TODO recuperer taille du tampon 
		int taille_tampon=3;
		Tampon tampon = new ProdCons(taille_tampon);
		
		Producteur p[] = null;// posse possiblement probleme comme initialisation
		int moyenneTempsDeTraitement= 10;//TODO a changer
		int deviationTempsDeTraitement =10;//TODO a changer
		for (int i=0;i<=nb_prod;i++){
			p[i]=new Producteur(Producteur.Prod(), Obs, moyenneTempsDeTraitement, deviationTempsDeTraitement, tampon); 
		}
		
		Consommateur c[]=null;// posse possiblement probleme comme initialisation
		moyenneTempsDeTraitement= 10;//TODO a changer
		deviationTempsDeTraitement =10;//TODO a changer
		for (int i=0;i<=nb_prod;i++){
			c[i]=new Consommateur(Consommateur.Cons(), Obs, moyenneTempsDeTraitement, deviationTempsDeTraitement, tampon); 
		}
		boolean b= true;
		for (int i=0;i<nb_prod;i++){
			p[i].run();
			b=b && p[i].isAlive();
		}
		if (b && (tampon.enAttente()>0)){
		for (int i=0;i<nb_conso;i++){
			c[i].run();
		}}
	}

	public static void main(String[] args) {
		new TestProdCons(new Observateur()).start();
	}
	
	
	



}
