package projet_prod_cons;

import java.util.ArrayList;

import jus.poc.prodcons.*;

public class TestProdCons  extends Simulateur {
	private Observateur obs;
	
	public TestProdCons(Observateur observateur) {
		super(observateur);
		this.obs=observateur;
	}

	

	@Override
	protected void run() throws Exception {
		// TODO Auto-generated method stub
		//corps du programme principal
		//TODO recuperer l nombre de producteur 
		int nb_prod=10;
		//TODO recuperer nombre conso
		int nb_conso=5;
		
	//TODO recuperer taille du tampon 
		int taille_tampon=3;
		Tampon tampon = new ProdCons(taille_tampon);
		System.out.println("j'ai cree le tampon\n");
		
		Acteur prod;
		ArrayList <Producteur> p= new ArrayList<Producteur>();// posse possiblement probleme comme initialisation
		int moyenneTempsDeTraitement= 10;//TODO a changer
		int deviationTempsDeTraitement =5;//TODO a changer
		for (int i=0;i<=nb_prod;i++){
			System.out.println("je suis la \n");
			prod=new Producteur(Producteur.Prod(), obs, moyenneTempsDeTraitement, deviationTempsDeTraitement, tampon);
			System.out.println("je suis la bis\n");
			p.set(i,(Producteur)prod); 
			System.out.println("prout\n");
		}
		System.out.println("J'ai cree les prod\n");
		ArrayList <Consommateur> c= new  ArrayList<Consommateur>();// posse possiblement probleme comme initialisation
		moyenneTempsDeTraitement= 10;//TODO a changer
		deviationTempsDeTraitement =10;//TODO a changer
		for (int i=0;i<=nb_prod;i++){
			c.set(i,new Consommateur(Consommateur.Cons(), obs, moyenneTempsDeTraitement, deviationTempsDeTraitement, tampon)); 
		}
		System.out.println("j'ai cree les conso\n");
		boolean b= true;
		
		for (int i=0;i<nb_prod;i++){
			p.get(i).run();
			b=b && p.get(i).isAlive();
		}
		if (b && (tampon.enAttente()>0)){
		for (int i=0;i<nb_conso;i++){
			c.get(i).run();
		}}
	}

	public static void main(String[] args) {
		new TestProdCons(new Observateur()).start();
	}
	
	
	



}
